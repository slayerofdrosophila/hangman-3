<%- include('bootheader') -%>
<%- include('menubar') -%>

<script src="/socket.io/socket.io.js"></script>
<script>

  var socket = io();
  socket.emit("roomid",<%- roomid %>)

  socket.on('refresh', function(msg) {
    console.log("reloadign")
    location.reload()
  });

  socket.on('sendToGame', function(msg) {
    console.log("reloadsendtogameign")
    window.location.href = "/gameScreen"
  });
</script>


<h4>Room <%= roomid %> </h4>

<div>
  There are <%= gameApp.waitingRooms[roomid].readyPlayers.length %> / <%= gameApp.waitingRooms[roomid].maxPlayers%> (<%= gameApp.waitingRooms[roomid].minPlayers %>) players ready. <br>
  There are <%= gameApp.waitingRooms[roomid].playerIds.length %> players in this room. <br>
</div>
<br>


<form method="post" action ="/submitWord" autocomplete="off">
  <input type="text" name="word" /> write your word <br>
  <input type="submit" value="Submit"/>
</form>

<br>

<% if ( gameApp.waitingRooms[roomid].readyPlayers.length >= gameApp.waitingRooms[roomid].minPlayers && gameApp.waitingRooms[roomid].firstPlayer == gameApp.waitingRooms[roomid].players[googleid]){ %>
  <form method="post" action ="/startRoom" autocomplete="off">
    <input type="submit" value="Start Game Early"/>
  </form> <hr>
<% } %>

<br>

<table class="table table-bordered table-striped">
    <thead>
      <tr>
        <td>Connected players:</td>
        <td>Text</td>
      </tr>
    </thead>
  <% Object.keys(gameApp.waitingRooms[roomid].players).forEach(googleid => {%>
    <tr>
      <td> <%= gameApp.waitingRooms[roomid].players[googleid].displayName %></td>
      <td>
        <% if (gameApp.waitingRooms[roomid].firstPlayer == gameApp.waitingRooms[roomid].players[googleid]){ %>
          <p>Host</p>
        <% } %>
      </td>
    </tr>
  <% }) %>
</table>



<%- include('bootfooter') -%>

